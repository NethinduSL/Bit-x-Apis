// BitX/text.js
// Sinhala Unicode → Wijesekara Converter

const sinhalaToWijesekaraMap = {
'අ':'w','ආ':'wd','ඇ':'we','ඈ':'wE','ඉ':'b','ඊ':'B','උ':'W','ඌ':'W!','එ':'t','ඒ':'ta','ඓ':'ft','ඔ':'T','ඕ':'´','ඖ':'T!',
'ඍ':'R','ඎ':'ඎ','ඏ':'ඏ','ඐ':'ඐ',
'ක්':'la','ක':'l','කා':'ld','කැ':'le','කෑ':'lE','කි':'ls','කී':'lS','කු':'l=','කූ':'l+','කෙ':'fl','කේ':'fla','කෛ':'ffl','කො':'fld','කෝ':'flda','කෞ':'fl!','ක්‍ය':'lH',
'ඛ්':'Ä','ඛ':'L','ඛා':'Ld','ඛැ':'Le','ඛෑ':'LE','ඛි':'Å','ඛී':'Ç','ඛු':'Lq','ඛූ':'LQ','ඛෙ':'fn','ඛේ':'fÄ','ඛෛ':'Lෛ','ඛො':'fLd','ඛෝ':'fLda','ඛෞ':'Lෞ','ඛ්‍ය':'LH',
'ග්':"f'","ග":">a","ගා":">","ගැ":">d","ගෑ":">e","ගි":">E","ගී":">s","ගු":">S","ගූ":">q","ගෙ":">Q","ගේ":"f>","ගෛ":">ෛ","ගො":"f>d","ගෝ":"f>da","ගෞ":">ෞ","ග්‍ය":">H",
'ඝ්':'Ûa','ඝ':'Û','ඝා':'Ûd','ඝැ':'Ûe','ඝෑ':'ÛE','ඝි':'Ûs','ඝී':'ÛS','ඝු':'Ûq','ඝූ':'ÛQ','ඝෙ':'fÛ','ඝේ':'fÛa','ඝෛ':'Ûෛ','ඝො':'fÕd','ඝෝ':'fÛda','ඝෞ':'Ûෞ','ඝ්‍ය':'ÛH',
'ඞ්':'É','ඞ':'J','ඞා':'Jd','ඞැ':'Je','ඞෑ':'JE','ඞි':'Js','ඞී':'JS','ඞු':'Jq','ඞූ':'JQ','ඞෙ':'fJ','ඞේ':'fJa','ඞෛ':'Jෛ','ඞො':'fJd','ඞෝ':'fJda','ඞෞ':'Jෞ','ඞ්‍ය':'JH',
'ඟ්':'þ','ඟ':'P','ඟා':'Pd','ඟැ':'Pe','ඟෑ':'PE','ඟි':'pE','ඟී':'Ñ','ඟු':'Pq','ඟූ':'PQ','ඟෙ':'fp','ඟේ':'fÉ','ඟෛ':'ffp','ඟො':'fpd','ඟෝ':'fpda','ඟෞ':'fp!','ඟ්‍ය':'pH',
'ච්':'Ê','ච':'c','චා':'cd','චැ':'ce','චෑ':'cE','චි':'ð','චී':'Ô','චු':'cq','චූ':'cQ','චෙ':'fc','චේ':'f–','චෛ':'ffc','චො':'fcd','චෝ':'fcda','චෞ':'fc!','ච්‍ය':'cH',
'ඡ්':'[a','ඡ':'[','ඡා':'[d','ඡැ':'[e','ඡෑ':'[E','ඡි':'[s','ඡී':'[S','ඡු':'[q','ඡූ':'[Q','ඡෙ':'f[','ඡේ':'f[a','ඡෛ':'[ෛ','ඡො':'f[d','ඡෝ':'f[da','ඡෞ':'[!','ඡ්‍ය':'[H',
'ජ්':'{a','ජ':'{','ජා':'{d','ජැ':'{e','ජෑ':'{E','ජි':'{s','ජී':'{S','ජු':'{q','ජූ':'{Q','ජෙ':'f{','ජේ':'f{a','ජෛ':'{ෛ','ජො':'f{d','ජෝ':'f{da','ජෞ':'{!','ජ්‍ය':'{H',
'ඣ්':'Ü','ඣ':'g','ඣා':'gd','ඣැ':'ge','ඣෑ':'gE','ඣි':'gq','ඣී':'gQ','ඣු':'fg','ඣූ':'fÜ','ඣෙ':'fgd','ඣේ':'fgda','ඣෛ':'gෛ','ඣො':'fg!','ඣෝ':'Ga','ඣෞ':'G','ඣ්‍ය':'GH',
'ඤ්':'â','ඤ':'v','ඤා':'vd','ඤැ':'ve','ඤෑ':'vE','ඤි':'ä','ඤී':'ã','ඤු':'vq','ඤූ':'vQ','ඤෙ':'fv','ඤේ':'fâ','ඤෛ':'vෛ','ඤො':'fvd','ඤෝ':'fvda','ඤෞ':'fv!','ඤ්‍ය':'vH',
'ඥ්':'Va','ඥ':'V','ඥා':'Vd','ඥැ':'Ve','ඥෑ':'VE','ඥි':'Vs','ඥී':'Î','ඥු':'Vq','ඥූ':'VQ','ඥෙ':'fV','ඥේ':'fa','ඥෛ':'Vෛ','ඥො':'fVd','ඥෝ':'fVda','ඥෞ':'Vෞ','ඥ්‍ය':'VH',
'ඦ්':'Ka','ඦ':'K','ඦා':'Kd','ඦැ':'Ke','ඦෑ':'KE','ඦි':'Ks','ඦී':'”','ඦු':'Kq','ඦූ':'KQ','ඦෙ':'fK','ඦේ':'fKa','ඦෛ':'Kෛ','ඦො':'fKd','ඦෝ':'fKda','ඦෞ':'Kෞ','ඦ්‍ය':'KH',
'ට්':'å','ට':'ඬ','ටා':'ඬd','ටැ':'ඬe','ටෑ':'ඬE','ටි':'ç','ටී':'é','ටු':'ඬq','ටූ':'ඬQ','ටෙ':'fË','ටේ':'få','ටෛ':'ඬෛ','ටො':'fËd','ටෝ':'fËda','ටෞ':'ඬෞ','ට්‍ය':'ඬH',
'ඨ්':';a','ඨ':';','ඨා':';d','ඨැ':';e','ඨෑ':';E','ඨි':';s','ඨී':';S','ඨු':';q','ඨූ':';Q','ඨෙ':'f;','ඨේ':'f;a','ඨෛ':';ෛ','ඨො':'f;d','ඨෝ':'f;da','ඨෞ':';ෞ','ඨ්‍ය':';H',
'ඩ්':':a','ඩ':':','ඩා':':d','ඩැ':':e','ඩෑ':':E','ඩි':':s','ඩී':'Ò','ඩු':':q','ඩූ':':Q','ඩෙ':'f(','ඩේ':'f(a','ඩෛ':':ෛ','ඩො':'f(d','ඩෝ':'f(da','ඩෞ':':ෞ','ඩ්‍ය':':H',
'ඪ්':'oa','ඪ':'o','ඪා':'od','ඪැ':'oe','ඪෑ':'oE','ඪි':'È','ඪී':'§','ඪු':'ÿ','ඪූ':'¥','ඪෙ':'fo','ඪේ':'foa','ඪෛ':'oෛ','ඪො':'fod','ඪෝ':'foda','ඪෞ':'fo!','ඪ්‍ය':'oH',
'ණ්':'è','ණ':'O','ණා':'Od','ණැ':'Oe','ණෑ':'OE','ණි':'ê','ණී':'ë','ණු':'Oq','ණූ':'OQ','ණෙ':'fO','ණේ':'fè','ණෛ':'Oෛ','ණො':'fOd','ණෝ':'fOda','ණෞ':'Oෞ','ණ්‍ය':'OH',
'න්':'ka','න':'k','නා':'kd','නැ':'ke','නෑ':'kE','නි':'ks','නී':'kS','නු':'kq','නූ':'kQ','නෙ':'fk','නේ':'fka','නෛ':'kෛ','නො':'fkd','නෝ':'fkda','නෞ':'fk!','න්‍ය':'kah',
'ඳ්':'|a','ඳ':'|','ඳා':'|d','ඳැ':'|e','ඳෑ':'|E','ඳි':'|s','ඳී':'|S','ඳු':'|q','ඳූ':'|Q','ඳෙ':'f|','ඳේ':'f|a','ඳෛ':'|ෛ','ඳො':'f|d','ඳෝ':'f|da','ඳෞ':'|ෞ','ඳ්‍ය':'|H',
'ප්':'ma','ප':'m','පා':'md','පැ':'me','පෑ':'mE','පි':'ms','පී':'mS','පු':'mq','පූ':'mQ','පෙ':'fm','පේ':'fma','පෛ':'ffm','පො':'fmd','පෝ':'fmda','පෞ':'fm!','ප්‍ය':'mH',
'ඵ්':'Ma','ඵ':'M','ඵා':'Md','ඵැ':'Me','ඵෑ':'ME','ඵි':'Ms','ඵී':'MS','ඵු':'Mq','ඵූ':'MQ','ඵෙ':'fM','ඵේ':'fMa','ඵෛ':'Mෛ','ඵො':'fMd','ඵෝ':'fMda','ඵෞ':'Mෞ','ඵ්‍ය':'MH',
'බ්':'í','බ':'n','බා':'nd','බැ':'ne','බෑ':'nE','බි':'ì','බී':'î','බු':'nq','බූ':'nQ','බෙ':'fn','බේ':'fna','බෛ':'nෛ','බො':'fnd','බෝ':'fnda','බෞ':'fn!','බ්‍ය':'nH',
'භ්':'Na','භ':'N','භා':'Nd','භැ':'Ne','භෑ':'NE','භි':'Ns','භී':'NS','භු':'Nq','භූ':'NQ','භෙ':'fN','භේ':'fNa','භෛ':'Nෛ','භො':'fNd','භෝ':'fNda','භෞ':'Nෞ','භ්‍ය':'NH',
'ම්':'í','ම':'u','මා':'ud','මැ':'ue','මෑ':'uE','මි':'ï','මී':'u','මු':'uq','මූ':'uQ','මෙ':'fu','මේ':'fï','මෛ':'ffu','මො':'fud','මෝ':'fuda','මෞ':'fu!','ම්‍ය':'uH',
'ඹ්':'ò','ඹ':'U','ඹා':'Ud','ඹැ':'Ue','ඹෑ':'UE','ඹි':'ô','ඹී':'ö','ඹු':'Uq','ඹූ':'UQ','ඹෙ':'fU','ඹේ':'fò','ඹෛ':'Uෛ','ඹො':'fUd','ඹෝ':'fUda','ඹෞ':'Uෞ','ඹ්‍ය':'UH',
'ය්':'ha','ය':'h','යා':'hd','යැ':'he','යෑ':'hE','යි':'hs','යී':'hS','යු':'hq','යූ':'hQ','යෙ':'fh','යේ':'fha','යෛ':'hෛ','යො':'fhd','යෝ':'fhda','යෞ':'h!','ය්‍ය':'hH',
'ර්':'¾','ර':'r','රා':'rd','රැ':'/','රෑ':'?','රි':'ß','රී':'Í','රු':'re','රූ':'rE','රෙ':'fr','රේ':'f¾','රෛ':'rෛ','රො':'frd','රෝ':'frda','රෞ':'fr!','ර්‍ය':'rH',
'ල්':',a','ල':'l','ලා':',d','ලැ':',e','ලෑ':',E','ලි':',s','ලී':',S','ලු':',q','ලූ':',Q','ලෙ':'f,','ලේ':'f,a','ලෛ':',ෛ','ලො':'f,d','ලෝ':'f,da','ලෞ':',!','ල්‍ය':',H',
'ව්':'õ','ව':'j','වා':'jd','වැ':'je','වෑ':'jE','වි':'js','වී':'jS','වු':'jq','වූ':'jQ','වෙ':'fj','වේ':'fja','වෛ':'jෛ','වො':'fjd','වෝ':'fjda','වෞ':'j!','ව්‍ය':'jH',
'ශ්':'Ya','ශ':'Y','ශා':'Yd','ශැ':'Ye','ශෑ':'YE','ශි':'Ys','ශී':'YS','ශු':'Yq','ශූ':'YQ','ශෙ':'fY','ශේ':'fYa','ශෛ':'Yෛ','ශො':'fYd','ශෝ':'fYda','ශෞ':'Y!','ශ්‍ය':'YH',
'ෂ්':'Ia','ෂ':'I','ෂා':'Id','ෂැ':'Ie','ෂෑ':'IE','ෂි':'Is','ෂී':'IS','ෂු':'Iq','ෂූ':'IQ','ෂෙ':'fI','ෂේ':'fIa','ෂෛ':'Iෛ','ෂො':'fId','ෂෝ':'fIda','ෂෞ':'I!','ෂ්‍ය':'IH',
'ස්':'ia','ස':'i','සා':'id','සැ':'ie','සෑ':'iE','සි':'is','සී':'iS','සු':'iq','සූ':'iQ','සෙ':'fi','සේ':'fia','සෛ':'iෛ','සො':'fid','සෝ':'fida','සෞ':'fi!','ස්‍ය':'iH',
'හ්':'ya','හ':'y','හා':'yd','හැ':'ye','හෑ':'yE','හි':'ys','හී':'yS','හු':'yq','හූ':'yQ','හෙ':'fy','හේ':'fya','හෛ':'yෛ','හො':'fyd','හෝ':'fyda','හෞ':'y!','හ්‍ය':'yH',
'ළ්':'<a','ළ':'<','ලා':'<d','ළැ':'<e','ළෑ':'<E','ළි':'<s','ළී':'<S','ළු':'<q','ළූ':'<Q','ළෙ':'f<','ළේ':'f<a','ළෛ':'<ෛ','ළො':'f<d','ළෝ':'f<da','ළෞ':'<!','ළ්‍ය':'<H',
'ෆ්':'*a','ෆ':'*','ෆා':'*d','ෆැ':'*e','ෆෑ':'*E','ෆි':'*s','ෆී':'*S','ෆු':'*q','ෆූ':'*Q','ෆෙ':'f*','ෆේ':'f*a','ෆෛ':'*ෛ','ෆො':'f*d','ෆෝ':'f*da','ෆෞ':'*!','ෆ්‍ය':'*H',
'ක්‌ෂ':'la‌I','ක්‌ෂා':'la‌Id','ක්‌ෂැ':'la‌Ie','ක්‌ෂෑ':'la‌IE','ක්‌ෂි':'la‌Is','ක්‌ෂී':'la‌IS','ක්‌ෂු':'la‌Iq','ක්‌ෂූ':'la‌IQ','ක්‌ෂෙ':'la‌fI','ක්‌ෂේ':'la‌fIa','ක්‌ෂෛ':'la‌Iෛ','ක්‌ෂො':'la‌fId','ක්‌ෂෝ':'la‌fIda','ක්‌ෂෞ':'la‌fI!','ක්‌ෂ්‍ය':'la‌IH',
'.':'.',',':',',';':';',':':':','?':'?','!':'!','"':'"',"'" :"'",'(':'(',')':')','-':'-','—':'—','...':'...','෴':'￦'
};

function sinhalaToWijesekara(text,type=1){
  if(!text) return '';
  const keys=Object.keys(sinhalaToWijesekaraMap).sort((a,b)=>b.length-a.length);
  let result='';
  for(let i=0;i<text.length;){
    let matched=false;
    for(const key of keys){
      if(text.startsWith(key,i)){
        result+=sinhalaToWijesekaraMap[key];
        i+=key.length;
        matched=true;
        break;
      }
    }
    if(!matched){
      result+=text[i];
      i++;
    }
  }
  return result;
}

module.exports.text=async function(text,type=1){
  return sinhalaToWijesekara(text,type);
};
